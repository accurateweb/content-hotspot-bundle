services:
  aw_clickzone.admin.clickzone:
    class: Accurateweb\ContentHotspotBundle\Admin\ContentHotspotAdmin
    arguments: [~, '%hotspot_entity%', ~]
    tags:
      -
        name: sonata.admin
        manager_type: orm
        group: %aw_content_hotspot_admin.email_template_group%
        label: %aw_content_hotspot_admin.email_template_label%
    calls:
      - [ setModelManager, [ '@aw_clickzone.model.model_manager' ] ]
    tags:
      - { name: sonata.admin, manager_type: orm, group: text, label: Клик-зоны }

  aw_clickzone.model.model_manager:
    class: Accurateweb\ContentHotspotBundle\Model\ModelManager
    arguments: ['@doctrine', '@aw_clickzone.service.content_hotspot_pool']

  aw_clickzone.twig.click_zone_extension:
    class: Accurateweb\ContentHotspotBundle\Twig\ContentHotspotTwigExtension
    arguments: [ '@doctrine.orm.entity_manager', '@aw_clickzone.admin.clickzone', '%hotspot_entity%', '@session', '%security_provider_name%' ]
    tags:
      - { name: twig.extension }

  aw_clickzone.service.content_hotspot_pool:
    class: Accurateweb\ContentHotspotBundle\Service\ContentHotspotPool
    arguments: [[]]

  aw_clickzone.service.content_hotspot_loader:
    class: Accurateweb\ContentHotspotBundle\Service\ContentHotspotLoader
    arguments:
      - '@doctrine.orm.entity_manager'
      - '%hotspot_entity%'

  aw_clickzone.content_hotspot_manager:
    class: Accurateweb\ContentHotspotBundle\Service\ContentHotspotManager
    arguments:
      - '@aw_clickzone.service.content_hotspot_pool'
      - '@aw_clickzone.service.content_hotspot_loader'